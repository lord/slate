<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_webhook">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="webhooks">Webhooks</h1>

<h2 id="lista-de-todos-os-webhooks">Lista de Todos os Webhooks</h2>
<pre class="highlight plaintext"><code>Listar Webhooks

DEFINIÇÃO

  GET https://app.cobrato.com/api/v1/webhooks

EXEMPLO DE REQUISIÇÃO

  $ curl -i -u $API_TOKEN:X
    -H 'User-Agent: My App 1.0' \
    -H 'Accept: application/json' \
    -H 'Content-type: application/json' \
    -X GET https://app.cobrato.com/api/v1/webhooks

EXEMPLO DE ESTADO DA RESPOSTA

    200 OK

EXEMPLO DE CORPO DA RESPOSTA

  {
    "webhooks":
      [
        {
          //informações webhook 1
        },
        {
          //informações webhook 2
        },
        ...
      ]
  }
</code></pre>

<p>Retorna uma lista em JSON contendo todos os webhooks pertencentes a sua Conta de Serviço.</p>

<h2 id="informações-do-webhook">Informações do Webhook</h2>
<pre class="highlight plaintext"><code>Mostra Webhook

DEFINIÇÃO

  GET https://app.cobrato.com/api/v1/webhooks/:webhook_id

EXEMPLO DE REQUISIÇÃO

  $ curl -i -u $API_TOKEN:X
    -H 'User-Agent: My App 1.0' \
    -H 'Accept: application/json' \
    -H 'Content-type: application/json' \
    -X GET https://app.cobrato.com/api/v1/webhooks/:webhook_id

EXEMPLO DE ESTADO DA RESPOSTA

    200 OK

EXEMPLO DE CORPO DA RESPOSTA

  {
    "id": 1,
    "url": "http://www.seusitema.com/cobrato",
    "description": "teste",
    "_links": [
      {"rel":"self","method":"GET","href":"http://localhost:3000/api/v1/webhooks/1"},
      {"rel":"update","method":"PUT","href":"http://localhost:3000/api/v1/webhooks/1"},
      {"rel":"destroy","method":"DELETE","href":"http://localhost:3000/api/v1/webhooks/1"}
    ]
  }

</code></pre>

<p>Retorna as informações detalhadas do webhook em formato JSON.</p>
<pre class="highlight plaintext"><code>Criar Webhook

DEFINIÇÃO

  POST https://app.cobrato.com/api/v1/webhooks

EXEMPLO DE REQUISIÇÃO

  $ curl -i -u $API_TOKEN:X
    -H 'User-Agent: My App 1.0' \
    -H 'Accept: application/json' \
    -H 'Content-type: application/json' \
    -X POST https://app.cobrato.com/api/v1/webhooks
    -D '{
        "url": "http://www.seusitema.com/cobrato",
        "description": "Webhook teste"
      }'

EXEMPLO DE ESTADO DA RESPOSTA COM SUCESSO

    201 Created

EXEMPLO DE ESTADO DA RESPOSTA COM INSUCESSO

    422 Unprocessable Entity

EXEMPLO DE CORPO DA RESPOSTA COM INSUCESSO

  {
    "errors": {
      "url": [
        "não é válida",
        "não pode ficar em branco",
        "não é válido"
      ]
    }
  }

</code></pre>

<h2 id="criação-de-webhook">Criação de Webhook</h2>

<p>Cria um novo webhook, retornando as informações do mesmo caso haja sucesso. Para realizar o cadastro é necessária que a URL informa aceite as requisições POST e GET, respondendo sempre com HTTP 200. Afim de verificação da URL, o Cobrato fará requisições testes a mesma</p>

<p>Parâmetros</p>

<p>url:  string requirido
URL na qual serão feitas as requisições GET e POST, esperando HTTP 200 como retorno
description:  string
Descrição opcional do Webhook</p>

<h2 id="atualização-de-webhook">Atualização de Webhook</h2>
<pre class="highlight plaintext"><code>Atualizar Webhook

DEFINIÇÃO

  PUT https://app.cobrato.com/api/v1/webhooks/:webhook_id
  PATCH https://app.cobrato.com/api/v1/webhooks/:webhook_id

EXEMPLO DE REQUISIÇÃO

  $ curl -i -u $API_TOKEN:X
    -H 'User-Agent: My App 1.0' \
    -H 'Accept: application/json' \
    -H 'Content-type: application/json' \
    -X PATCH https://app.cobrato.com/api/v1/webhooks/:webhook_id
    -D '{
        "city": "Farroupilha",
        "state": "RS"
      }'

EXEMPLO DE ESTADO DA RESPOSTA COM SUCESSO

    200 OK

EXEMPLO DE ESTADO DA RESPOSTA COM CEDENTE INEXISTENTE

    404 Not Found

EXEMPLO DE ESTADO DA RESPOSTA COM INSUCESSO

    422 Unprocessable Entity

</code></pre>

<p>Atualiza a descrição do webhook. Não é possível alterar a URL de um Webhook. A requisição não diferencia a utilização dos verbos PUT e PATCH.</p>

<p>Parâmetros</p>

<p>description:  string
Descrição opcional do Webhook</p>

<h2 id="exclusão-de-webhook">Exclusão de Webhook</h2>
<pre class="highlight plaintext"><code>Excluir Webhook

DEFINIÇÃO

  DELETE https://app.cobrato.com/api/v1/webhooks/:webhook_id

EXEMPLO DE REQUISIÇÃO

  $ curl -i -u $API_TOKEN:X
    -H 'User-Agent: My App 1.0' \
    -H 'Accept: application/json' \
    -H 'Content-type: application/json' \
    -X DELETE https://app.cobrato.com/api/v1/webhooks/:webhook_id

EXEMPLO DE ESTADO DA RESPOSTA COM SUCESSO

    204 No Content

EXEMPLO DE ESTADO DA RESPOSTA COM WEBHOOK INEXISTENTE

    404 Not Found

</code></pre>

<p>Exclui determinado webhook. A exclusão é irreversível.</p>

<h2 id="payloads">Payloads</h2>

<p>Exemplos de requisições enviadas pelo webhook do Cobrato.</p>

<p>As ações notificadas são:</p>

<table><thead>
<tr>
<th>Objeto</th>
<th>Ação</th>
<th>Descrição</th>
</tr>
</thead><tbody>
<tr>
<td>charge</td>
<td>created</td>
<td>quando a cobrança é criada</td>
</tr>
<tr>
<td>charge</td>
<td>received</td>
<td>quando a cobrança é recebida</td>
</tr>
<tr>
<td>charge</td>
<td>undone_receivement</td>
<td>quando a cobrança tem seu recebimento desfeito</td>
</tr>
<tr>
<td>charge</td>
<td>updated</td>
<td>quando a cobrança é atualizada</td>
</tr>
<tr>
<td>charge</td>
<td>destroyed</td>
<td>quando a cobrança é excluída</td>
</tr>
<tr>
<td>charge</td>
<td>received</td>
<td>quando a cobrança é recebida</td>
</tr>
<tr>
<td>charge_account</td>
<td>created</td>
<td>quando a conta de cobrança é criada</td>
</tr>
<tr>
<td>charge_account</td>
<td>updated</td>
<td>quando a conta de cobrança é atualizada</td>
</tr>
<tr>
<td>charge_account</td>
<td>destroyed</td>
<td>quando a conta de cobrança é excluída</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
