Giosg BASKET
==========

Giosg BASKET is an additional product for Giosg Live. With basket you can monitor and analyze visitor's shopping carts in real time and generate different kinds of reports afterwards.

## How to setup basket tracking
Basket can be integrated to customer's online store with three different approaches:

- Use giosg javascript API.
- Use giosg [Basket configuration interface and CSS selectors](#setup-using-css-selectors).
- Direct backend integration from giosg platform to customer's online store application.

## What method should I use?
Recommended way is to use giosg javascript API. This requires site owners to make changes to site code but the changes are trivial and can be easily placed next to the code that tracks e-commerce events to other analytics platforms. This way the developers of the site can decide what to track and can make sure that the data submitted to giosg is same as submitted to other analytics services.

Second favorable method is to use direct backend integration but as this requires usually more work it is not the best option.

Third and the least favored method is to use CSS selectors to collect basket data from sites existing html structure. This is usually fastest to setup and is very good option for quickly testing out the service but is also the most error prone. In the long run this method causes a lot more trouble than using javascript API.

### Why using CSS selectors is not recommended?
because it doesn't work

===== Checklist for integration =====

  * Check that all pages contain giosg javascript tag. It's quite common that customers forgot to add giosg tag to payment pages and we can not log any succesfull purchases.
  * Find out CSS Selectors:
    * If you are using store's current HTML elments: get list of CSS selectors for basket.
    * If you are using giosg specific hidden html-elements: ensure that giosg elements are added to webstore.
  * Configure selectors for your website from the Domain settings. You can read more this from below.
  * When selectors are added to domain's settings:
    - Check from browser's console that there is not any Javascript errors.
    - Check that cart information is shown correctly on giosg's service (visitor info).
    - Wait couple of days and compare that store's actual sale and giosg's reports match.






    ===== 3. Direct back end integration from giosg platform to customer's online store application =====

    This approach is the most robust and reliable, but it means that we have to do e-commerce application specific integration project. In this approach we make API calls directly to store's application server in order to  fetch visitor's current shopping cart status. Calls are made every time when visitor changes page or pages document tree is changed.

    If this is the option you need, please contact [[http://www.giosg.com/contact-us/|giosg sales team]]






## Application Request
When application is launched a launch url will be generated for application. This url is combinations of configured application url and query string parameters generated by giosg. This url is then returned to client and client will create iframe with this url which results to GET requests to application. Data in query strings parameters is encoded to [JWT tokens](http://jwt.io/).

```
// Example of application request url:
https://myappp.com/app.html?type=chat_start&data=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb21pY191cmwiOiJodHRwOi8veGtjZC5jb20vMTM2MC8ifQ.BsjBt9a9imoj9P5_7aIAe5nuhPd5jb8HGvAJKPCwm6A&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb21pY191cmwiOiJodHRwOi8veGtjZC5jb20vMTM2MC8ifQ.BsjBt9a9imoj9P5_7aIAe5nuhPd5jb8HG
```

**List of fields in `data` JWT Token**

Field   | Type   | Description
------------|--------|----------
`sub` | string | Subject of the token. Ie. `service.giosg.com`.
`exp` | timestamp | Token expiration timestamp. Automatically used by most JWT implementations to make sure that token is not expired.
`user_id` | UUID | UUID of the current user or `None` if not applicable.
`org_id` | UUID | UUID of the organization/company where the `user_id` belongs to.
`chat_id` | UUID | UUID of the chat sessions if applicable or `None`.
`visitor_id` | VisitorID | ID of the visitor if applicable or `None`.
`inst_id` | UUID | UUID of the application instance/installation.
`app_id` | UUID | UUID of the application definition.

**List of parameters `token` JWT Token**

Field   | Type   | Description
------------|--------|----------
`sub` | string | Subject of the token. Ie. `service.giosg.com`.
`exp` | timestamp | Token expiration timestamp. Automatically used by most JWT implementations to make sure that token is not expired.
`user_id` | UUID | UUID of the current user or `None` if not applicable.
`org_id` | UUID | UUID of the organization/company where the `user_id` belongs to.
`inst_id` | UUID | UUID of the application instance/installation.
`app_id` | UUID | UUID of the application definition.
`perms` | List of strings |  List of strings representing applications permission


# Setup using javascript API
Applications are required to use SSL in order to be accepted as Giosg Apps. Currently UI allows saving pretty much anything as application url but requests will fail if the url doesn't start with HTTPS.

To develop apps locally it is possible to allow insecure urls by setting `allow_insecure_url` to `True` manually on database. No UI is provided for this to not make it too easy for some weak minded people to allow this for our customers! ;) Another possibility is to generate self signed certificate.

For production apps it is also possible to get free certificates from StartSSL and some other providers. Also it is possible to use CloudFlare in front of the app to get SSL for free.

# Setup using backend integration
If you want to use direct backend integration please contact giosg support for more details. You can reach giosg support by chatting at [giosg.com](http://www.giosg.com/) or by sending email to [support@giosg.com](mailto:support@giosg.com).

# Setup using CSS selectors
Applications are required to use SSL in order to be accepted as Giosg Apps. Currently UI allows saving pretty much anything as application url but requests will fail if the url doesn't start with HTTPS.

To develop apps locally it is possible to allow insecure urls by setting `allow_insecure_url` to `True` manually on database. No UI is provided for this to not make it too easy for some weak minded people to allow this for our customers! ;) Another possibility is to generate self signed certificate.

For production apps it is also possible to get free certificates from StartSSL and some other providers. Also it is possible to use CloudFlare in front of the app to get SSL for free.
